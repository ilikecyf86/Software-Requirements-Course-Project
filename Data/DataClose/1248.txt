Refactor snapshots deletion mechanism
kind/enhancement 
For now we have snapshot deletion mechanism which doesn't respect connection types and any kind of auth. We definitely should improve it.